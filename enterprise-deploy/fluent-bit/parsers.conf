# ==========================================
# Apache Access Log Parser (X-Forwarded-For)
# ==========================================
[PARSER]
    Name        apache_access_forwarded
    Format      regex
    Regex       ^(?<remote_ip>[^ ]+) [^ ]+ (?<remote_user>[^ ]+) \[(?<time>[^\]]+)\] "(?<request_method>[^ ]+) (?<request_uri>[^ ]+) (?<http_version>[^"]+)" (?<status>[0-9]+) (?<body_bytes_sent>[0-9]+|-) "(?<http_referrer>[^"]*)" "(?<http_user_agent>[^"]*)"$
    Time_Key    time
    Time_Format %d/%b/%Y:%H:%M:%S %z
    Types       status:integer body_bytes_sent:integer

# ==========================================
# Apache Error Log Parser
# ==========================================
[PARSER]
    Name        apache_error
    Format      regex
    Regex       ^\[(?<time>[^\]]+)\] \[(?<module>[^:]*):(?<severity>[^\]]*)\] \[pid (?<pid>[^\]]*)\]( \[client (?<client>[^\]]*)\])? (?<message>.*)$
    Time_Key    time
    Time_Format %a %b %d %H:%M:%S.%L %Y
    Types       pid:integer

# ==========================================
# Laravel JSON Log Parser
# ==========================================
[PARSER]
    Name        laravel_json
    Format      json
    Time_Key    datetime
    Time_Format %Y-%m-%d %H:%M:%S
    Time_Keep   On

[PARSER]
    Name        laravel_json_detailed
    Format      json
    Time_Key    datetime
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ
    Time_Keep   On
    Decode_Field_As json context
    Decode_Field_As json extra

# ==========================================
# Laravel Plain Text Parser (fallback)
# ==========================================
[PARSER]
    Name        laravel_plain
    Format      regex
    Regex       ^\[(?<time>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})\] (?<env>\w+)\.(?<level>\w+): (?<message>.*)$
    Time_Key    time
    Time_Format %Y-%m-%d %H:%M:%S

# ==========================================
# PHP-FPM Log Parser
# ==========================================
[PARSER]
    Name        php_fpm
    Format      regex
    Regex       ^\[(?<time>[^\]]+)\] (?<level>[^:]+): (?<message>.*)$
    Time_Key    time
    Time_Format %d-%b-%Y %H:%M:%S

# ==========================================
# Syslog Parser (RFC3164)
# ==========================================
[PARSER]
    Name        syslog_rfc3164
    Format      regex
    Regex       ^(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[^:\[]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<message>.*)$
    Time_Key    time
    Time_Format %b %d %H:%M:%S
    Time_Keep   On
    Types       pid:integer

# ==========================================
# Docker JSON Parser (for container logs)
# ==========================================
[PARSER]
    Name        docker
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ
    Time_Keep   On
    Decode_Field_As json log